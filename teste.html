<!DOCTYPE html>
<html>
<head>
  <title>Leitura de Planilha Online</title>
  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
</head>
<body>
  <h1>Leitura de Planilha Online</h1>

  <div id="dados-planilha"></div>

  <script>
function encontrarPalavrasChave(relatorio) {
  const palavrasChave = {
    supervisório: ['supervisório', 'supervisory', 'supervisor'],
    instrumentoDeCampo: ['instrumento de campo', 'field instrument'],
    erroDeLógica: ['erro de lógica', 'logic error'],
    mauFuncionamentoDeEquipamento: ['mau funcionamento de equipamento', 'equipment malfunction'],
    faltaDeComunicaçãoNaRede: ['falta de comunicação na rede', 'network communication failure']
  };

  const palavrasEncontradas = [];

  Object.entries(palavrasChave).forEach(([palavraChave, sinonimos]) => {
    sinonimos.forEach(sinonimo => {
      if (relatorio.toLowerCase().includes(sinonimo)) {
        palavrasEncontradas.push(palavraChave);
      }
    });
  });

  return palavrasEncontradas;
}

// Exemplo de relatório
const relatorio = `
Turno: D 18h00 - 06h00 - Pedro Angelu
Matricula: C0679576
Data: 02/04/2024
Processo: Mina de Sapecado
Incidente: INC02480008
Equipamento: 11-BR-09
Acionamento: 02/04/2024 às 19:25
Problema: rede supervisório Acionador pela equipe da manutenção devido a falha de mudança de operação do equipamento 11-BR-09, relatado a não mudança do estado Remoto para Manutenção.
Solução: Foi verificado que não havia nenhum impedimento em relação a esta mudança ocorrendo via lógica, após alguns minutos a equipe de manutenção retornou informando mau contato e que o problema havia sido resolvido.
Não houve apontamento de parada
Encerramento: 02/04/2024 às 19:56`;

const palavrasChaveEncontradas = encontrarPalavrasChave(relatorio);
console.log(palavrasChaveEncontradas);
  </script>
</body>
</html>