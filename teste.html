<!DOCTYPE html>
<html>
<head>
  <title>Adicionar Dado em Arquivo CSV</title>
</head>
<body>
  <input type="file" id="fileInput">
  <br>
  <button id="btnAdicionar">Adicionar Dado</button>

  <script>
    // Função para adicionar um novo dado ao arquivo CSV
    async function adicionarDadoAoCSV(file, novoDado) {
      try {
        // Ler o conteúdo do arquivo CSV
        const contents = await file.text();

        // Separar as linhas do CSV
        const linhas = contents.split('\n');

        // Adicionar o novo dado à última linha
        const ultimaLinha = linhas[linhas.length - 1];
        const novaLinha = ultimaLinha + ',' + novoDado;
        linhas[linhas.length - 1] = novaLinha;

        // Criar o novo conteúdo CSV
        const novoConteudo = linhas.join('\n');

        // Criar um objeto de gravação de arquivo
        const writable = await file.createWritable();

        // Escrever o novo conteúdo no arquivo
        await writable.write(novoConteudo);

        // Fechar o arquivo
        await writable.close();

        console.log('Dado adicionado com sucesso ao arquivo CSV!');
      } catch (error) {
        console.error('Erro ao adicionar dado ao arquivo CSV:', error);
      }
    }

    // Evento de clique no botão
    document.getElementById('btnAdicionar').addEventListener('click', async function() {
      const caminhoArquivo = document.getElementById('fileInput').value;
      const novoDado = 'Novo Dado';

      try {
        const arquivo = await window.showOpenFilePicker({
          types: [
            {
              description: 'Arquivos CSV',
              accept: {
                'text/csv': ['.csv'],
              },
            },
          ],
        });
        
        if (arquivo.length > 0) {
          adicionarDadoAoCSV(arquivo[0], novoDado);
        }
      } catch (error) {
        console.error('Erro ao selecionar o arquivo:', error);
      }
    });
  </script>
</body>
</html>