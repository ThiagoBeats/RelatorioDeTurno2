<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>

<body>
 

  <script src="https://unpkg.com/xlsx/dist/xlsx.full.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', handleFile, false);
    var dados = ''
    function handleFile() {
      var input = document.getElementById('input');
      var filePath = "./recursos/DadosPico.xlsx";

      var xhr = new XMLHttpRequest();
      xhr.open('GET', filePath, true);
      xhr.responseType = 'arraybuffer';

      xhr.onload = function(e) {
        var data = new Uint8Array(xhr.response);
        var workbook = XLSX.read(data, { type: 'array' });

        workbook.SheetNames.forEach(function (sheetName) {
          var worksheet = workbook.Sheets[sheetName];
          var jsonData = XLSX.utils.sheet_to_json(worksheet, { header: 1 });

          //console.log('Sheet Name:', sheetName);
          //console.log('Sheet Data:', jsonData);
          dados = jsonData
          busca("lit");

          // Faça o que desejar com os dados da planilha
        });
      };

      xhr.send();
    }
    function busca(tag) {
      console.log("Iniciou");

      for (let index = 0; index < dados.length; index++) {
        //console.log(index + "|" + dados[index][1])
        if (typeof(dados[index][1]) != 'undefined') {
          if (dados[index][1].toUpperCase().includes(tag.toUpperCase())) {
            console.log('U.O: ' + dados[index][0] + " | Tag: " + dados[index][1] + " | PLC: " + dados[index][2] + " | Localidade: " + dados[index][3] + " | Comentários: " + dados[index][4]);
          }
        }
      }
    }
  </script>
</body>

</html>